Update the Create Invoice flow when converting a completed job/estimate to an invoice. Before sending to QuickBooks, show a comprehensive preview modal so the user can review all information. The modal header should say "Review Invoice Before Sending to QuickBooks" with a subtitle "Please verify all information is correct before creating the invoice".
Display an Invoice Summary section showing the job/estimate title, property name, total amount, and type badge. Include a Bill To / Ship To section with the customer name, C/O, ATTN, billing address, property shipping address, and company ship-from address. Show Invoice Details with invoice number (auto-generated or editable), invoice date, due date, terms (Net 30, etc.), and status dropdown.
Pull the Assignment Info from the completed job showing Repair Tech, Service Tech, Field Supervisor, Repair Foreman, Office Member, and Reported Date. Display Line Items in a table with columns for service date, product/service, SKU, description, quantity, rate, amount, and tax checkbox, followed by subtotal, discount, taxable subtotal, sales tax, and invoice total.
Include a Customer Notes & Attachments section with editable Note to Customer, Internal Customer Notes (hidden from customer), Memo on Statement (hidden), and an Attachments area showing completion photos from the job with options to add or remove files. Show a Send Invoice To section with billing contact dropdown from property contacts or manual email entry if no contacts found, plus CC/BCC options.
At the bottom, display "Cancel" button to close with no action, "Edit Details" button to modify fields, and "Confirm & Send to QuickBooks" as the primary action button. After clicking confirm, show a final confirmation popup asking "Are you sure you want to create this invoice in QuickBooks and send it to [customer email]?" with "Go Back" and "Yes, Create Invoice" buttons. After confirmation, create the invoice in QuickBooks via API, attach completion photos and documents, send to customer email, update the estimate/job status to "Invoiced", and show a success message with the invoice number and link to view in QuickBooks.